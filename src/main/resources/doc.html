<div>
    <span>
    <p>
        Это приложение написано на java (spring) и является преемником старого, написанного на php (laravel). <br>
        Отличия api/v1 от api/v2:
        <ul>
            <li>Исключены эндроинты POST /event-list, POST /news-list, POST /conflict-list</li>
            <li>Названия сущностей в пути стали в plural-форме (REST way)</li>
            <li>Параметры запросов и поля ответов теперь в camelCase</li>
            <li>Параметры queryString формируются по немного другим правилам. <br>
                Было: ?filters[published]=1&filters[date_from]=321312312 <br>
                стало: ?filters.published=true&filters.dateFrom=321312312.</li>
            <li>Ответ на запросы справочников и пользователя теперь обёрнуты в {"data": {...}}</li>
            <li>Полностью удалены комментарии и жалобы на комментарии</li>
            <li>/users переименован в /me. Добавлен метод на удаление пользователя из базы</li>
        </ul>
    </p>
    </p>Варианты локалей (locale): all, ru, en, es, de.<p>
    <ul>
        <li>При передаче [all] выводятся все варианты перевода сущностей и справочников. [titleRu, titleEn, titleEs, titleDe]</li>
        <li>При передаче [ru/en/es/de] выводится лишь одно поле [title], содержимое которого соответствует локали.</li>
        <li>При создании/обновлении сущностей локаль тоже влияет: если передана локаль [ru/en/es], то можно передавать [title], которое
            сохранится в базе в нужном поле.</li>
        <li>С любой локалью можно при сохранении/обновлении сущностей передавать поля с суффиксом локали [titleRu, titleEn, titleEs, titleDe],
            но если передать локаль [ru] и [title] без суффикса, то он будет иметь приоритет над [titleRu]</li>
    </ul>
    <p>Рекомендую всегда прикреплять к запросам заголовок Accept: application/json. Иначе можно получить html в ответе (при ошибках сервера)</p>
    <p>События и новости могут быть опубликованными или нет</p>
    <ul>
        <li>Только модераторы могут смотреть неопубликованные записи</li>
        <li>Только модераторы могут публиковать или снимать с публикации записи</li>
    </ul>
    Методы на обновление конфликтов, событий и новостей работают как PATCH
    это значит, что значения полей, которые не переданы в запросе на обновление, не изменятся
    Например, можно передать только {"published":true} в запросе на обновление новости. Новость опубликуется, поля не изменятся
    <p><u>Ролевая система:</u> <br>
    У каждого пользователя есть массив ролей. У обычных пользователей этот массив пустой. У администраторов в этом массиве есть 'ADMIN’,
    у модераторов - 'MODERATOR’.
    <br>
    <u>Иерархия конфликтов:</u> <br>
    Конфликты могут наследоваться через общее событие. Для связывания конфликта с родительским конфликтом необходимо
    в поле parentEventId дочернего конфликта сохранить id события (event) родительского конфликта, в котором происходит ветвление.
    После этого событие принадлежит обоим конфликтам, то есть при запросе
    /api/all/event с фильтром conflictIds в ответ будут попадать события, которые принадлежать конфликтам из conflictIds напрямую,
    либо через поле parentEventId.
    <br>
    Запрос /api/all/conflict с фильтром ancestorsOf выведет те конфликты, которые являются родителями (не только прямыми) переданного конфликта.
    <br>
    <u>Пуш-уведомления:</u> <br>
    Используется FCM Cloud Messaging. На период тестирования будут использоваться топики (а-ля комнаты, группы…): admin, newsRu [en/es/de], eventRu [en/es/de].<br>
    <br>
    Уведомления содержат заголовок и тело, а ещё содержат объект с данными. По составу данных в объекте принимаю пожелания, <br>
    но после согласования с Виталием (потому как я на правах бэкендера не разбираюсь в клиентских приложениях)</p>
    <ul>
        <li>
            Если создать событие/новость без публикации (это касается обычных пользователей, когда они предлагают новость/событие),
            то в топик 'admin' придёт уведомление с заголовком "ЗабастКом" и телом "На модерации новость от имя_автора".
            К уведомлению прикреплен объект с полями: id, creatorName, creatorId, type = 'admin'
        </li>
        <li>
            При публикации события/новости (это касается модераторов), а также при обновлении новости/события, если добавляется перевод,<br>
            в топики 'news_ru'/'event_ru' [en/es] придёт уведомление с заголовком "ЗабастКом" и телом, содержащим заголовок новости/события на нужном языке.<br>
            К уведомлению прикреплен объект с полями: id, title, creatorId, type = 'news' (независимо от сущности всегда 'news').<br>
            У событий в объекте будут два дополнительных поля: lat, lng <br><br>
            <u>Пример1:</u> существовала неопубликованная новость с title и content на двух языках (ru, es). Модератор публикует её - посылаются пуши <br>
            в топики news_ru, news_es. Cостав уведомлений сформирован с учётом локали (title новости на нужном языке, заголовок и тело пуша переведены)<br>
            <u>Пример2:</u> новость из первого примера нуждается в переводе на английский. Модератор обновляет её, добавляя title_en и title_es.
            Посылается пуш в топик news_en.
        </li>
        <li>
            При публикации события/новости посылается ещё один пуш.<br>
            Но уже не в топик, а персонально автору новости/события, если у него указан fcm-токен.<br>
            Придёт уведомление с заголовком "ЗабастКом" и телом 'Ваша новость прошла модерацию'/'Ваше событие прошло модерацию'.<br>
            К уведомлению прикреплен объект с полями id, messageRu/En/Es/De, creatorId, type = 'moderated'<br>
            В предыдущем пункте этот пуш будет отсылаться в первом примере, но не во втором
        </li>
        <li>
            При удалении модераторами неопубликованных новостей/событий автору удаленной записи (при наличии у него fcm-токена)
            будет приходить уведомление с заголовком "ЗабастКом", телом 'Ваша новость не прошла модерацию и была удалена'.
            В объекте придут поля: id, messageRu/En/Es/De (дублирует тело пуша, указанное в предыдущем предложении), creatorId, type ('moderated')
        </li>
    </ul>
    </span>
</div>